{"ast":null,"code":"import { NavigationEnd } from '@angular/router';\nimport { interval } from 'rxjs';\nimport { filter } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/event.service\";\nimport * as i2 from \"../../../services/ticket.service\";\nimport * as i3 from \"../../../services/auth.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nfunction DashboardComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"div\", 9)(2, \"span\", 10);\n    i0.ɵɵtext(3, \"Loading...\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"p\", 11);\n    i0.ɵɵtext(5, \"Adatok bet\\u00F6lt\\u00E9se...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction DashboardComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.error, \" \");\n  }\n}\nfunction DashboardComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"div\", 14)(2, \"div\", 15)(3, \"div\", 16)(4, \"div\", 17)(5, \"div\", 18);\n    i0.ɵɵelement(6, \"i\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 20)(8, \"h3\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\");\n    i0.ɵɵtext(11, \"Esem\\u00E9ny\");\n    i0.ɵɵelementEnd()()()()()();\n    i0.ɵɵelementStart(12, \"div\", 14)(13, \"div\", 21)(14, \"div\", 16)(15, \"div\", 17)(16, \"div\", 18);\n    i0.ɵɵelement(17, \"i\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"div\", 20)(19, \"h3\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"div\");\n    i0.ɵɵtext(22, \"Megv\\u00E1s\\u00E1rolt jegyek\");\n    i0.ɵɵelementEnd()()()()()();\n    i0.ɵɵelementStart(23, \"div\", 14)(24, \"div\", 23)(25, \"div\", 16)(26, \"div\", 17)(27, \"div\", 18);\n    i0.ɵɵelement(28, \"i\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"div\", 20)(30, \"h3\");\n    i0.ɵɵtext(31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"div\");\n    i0.ɵɵtext(33, \"\\u00D6sszes bev\\u00E9tel\");\n    i0.ɵɵelementEnd()()()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(9);\n    i0.ɵɵtextInterpolate(ctx_r2.totalEvents || \"0\");\n    i0.ɵɵadvance(11);\n    i0.ɵɵtextInterpolate(ctx_r2.totalActiveTickets || \"0\");\n    i0.ɵɵadvance(11);\n    i0.ɵɵtextInterpolate((ctx_r2.totalSales || \"0\") + \" Ft\");\n  }\n}\nfunction DashboardComponent_div_9_tr_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const month_r8 = ctx.$implicit;\n    const i_r9 = ctx.index;\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(month_r8);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r5.getEventCountByMonth(i_r9));\n  }\n}\nfunction DashboardComponent_div_9_tr_38_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\")(8, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function DashboardComponent_div_9_tr_38_Template_button_click_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const event_r10 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r11.editEvent(event_r10._id));\n    });\n    i0.ɵɵelement(9, \"i\", 40);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 41);\n    i0.ɵɵlistener(\"click\", function DashboardComponent_div_9_tr_38_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const event_r10 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.viewEvent(event_r10._id));\n    });\n    i0.ɵɵelement(11, \"i\", 42);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const event_r10 = ctx.$implicit;\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(event_r10.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r6.formatDate(event_r10.date));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r6.getAvailableTickets(event_r10));\n  }\n}\nfunction DashboardComponent_div_9_tr_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 43);\n    i0.ɵɵtext(2, \"Nincs megjelen\\u00EDthet\\u0151 esem\\u00E9ny\");\n    i0.ɵɵelementEnd()();\n  }\n}\nconst _c0 = function () {\n  return [\"Janu\\u00E1r\", \"Febru\\u00E1r\", \"M\\u00E1rcius\", \"\\u00C1prilis\", \"M\\u00E1jus\", \"J\\u00FAnius\", \"J\\u00FAlius\", \"Augusztus\", \"Szeptember\", \"Okt\\u00F3ber\", \"November\", \"December\"];\n};\nfunction DashboardComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"div\", 25)(2, \"div\", 26)(3, \"div\", 27)(4, \"h5\", 28);\n    i0.ɵɵelement(5, \"i\", 29);\n    i0.ɵɵtext(6, \"Esem\\u00E9nyek havi eloszl\\u00E1sa \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 16)(8, \"div\", 30)(9, \"table\", 31)(10, \"thead\")(11, \"tr\")(12, \"th\");\n    i0.ɵɵtext(13, \"H\\u00F3nap\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Esem\\u00E9nyek sz\\u00E1ma\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(16, \"tbody\");\n    i0.ɵɵtemplate(17, DashboardComponent_div_9_tr_17_Template, 5, 2, \"tr\", 32);\n    i0.ɵɵelementEnd()()()()()();\n    i0.ɵɵelementStart(18, \"div\", 25)(19, \"div\", 33)(20, \"div\", 27)(21, \"h5\", 28);\n    i0.ɵɵelement(22, \"i\", 34);\n    i0.ɵɵtext(23, \"Legk\\u00F6zelebbi esem\\u00E9nyek \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(24, \"div\", 16)(25, \"div\", 30)(26, \"table\", 35)(27, \"thead\")(28, \"tr\")(29, \"th\");\n    i0.ɵɵtext(30, \"Esem\\u00E9ny\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(31, \"th\");\n    i0.ɵɵtext(32, \"D\\u00E1tum\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(33, \"th\");\n    i0.ɵɵtext(34, \"El\\u00E9rhet\\u0151 jegyek\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(35, \"th\");\n    i0.ɵɵtext(36, \"M\\u0171veletek\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(37, \"tbody\");\n    i0.ɵɵtemplate(38, DashboardComponent_div_9_tr_38_Template, 12, 3, \"tr\", 32);\n    i0.ɵɵtemplate(39, DashboardComponent_div_9_tr_39_Template, 3, 0, \"tr\", 36);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(40, \"div\", 37)(41, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function DashboardComponent_div_9_Template_button_click_41_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.navigateToEvents());\n    });\n    i0.ɵɵtext(42, \"\\u00D6sszes esem\\u00E9ny\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(17);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpureFunction0(3, _c0));\n    i0.ɵɵadvance(21);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.events.slice(0, 5));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.events.length === 0);\n  }\n}\nfunction DashboardComponent_div_10_tr_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const category_r18 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(category_r18.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(category_r18.count);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", category_r18.revenue, \" Ft\");\n  }\n}\nfunction DashboardComponent_div_10_tr_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 46);\n    i0.ɵɵtext(2, \"Nincs megjelen\\u00EDthet\\u0151 adat\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction DashboardComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"div\", 44)(2, \"div\", 26)(3, \"div\", 27)(4, \"h5\", 28);\n    i0.ɵɵelement(5, \"i\", 45);\n    i0.ɵɵtext(6, \"Jegyek kateg\\u00F3ri\\u00E1nk\\u00E9nt \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 16)(8, \"div\", 30)(9, \"table\", 31)(10, \"thead\")(11, \"tr\")(12, \"th\");\n    i0.ɵɵtext(13, \"Kateg\\u00F3ria\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Jegyek sz\\u00E1ma\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\");\n    i0.ɵɵtext(17, \"Bev\\u00E9tel (Ft)\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(18, \"tbody\");\n    i0.ɵɵtemplate(19, DashboardComponent_div_10_tr_19_Template, 7, 3, \"tr\", 32);\n    i0.ɵɵtemplate(20, DashboardComponent_div_10_tr_20_Template, 3, 0, \"tr\", 36);\n    i0.ɵɵelementEnd()()()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(19);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.getTicketCategories());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.getTicketCategories().length === 0);\n  }\n}\nexport class DashboardComponent {\n  constructor(eventService, ticketService, authService, router) {\n    this.eventService = eventService;\n    this.ticketService = ticketService;\n    this.authService = authService;\n    this.router = router;\n    this.events = [];\n    this.tickets = [];\n    this.loading = true;\n    this.error = null;\n    // Statisztikai adatok\n    this.totalEvents = 0;\n    this.totalTickets = 0;\n    this.totalSales = 0;\n    this.totalActiveTickets = 0;\n    this.totalCancelledTickets = 0;\n    this.eventsByMonth = [];\n    this.ticketsByCategory = [];\n    // Hónapi események száma\n    this.monthlyEventCounts = [];\n    // Jegy kategóriák és statisztikák\n    this.ticketCategories = [];\n    // Automatikus frissítés és útvonal figyelelés\n    this.refreshSubscription = null;\n    this.routerSubscription = null;\n    this.lastTicketCount = 0; // Utóbbi jegyszám összehasonlításhoz\n  }\n\n  ngOnInit() {\n    if (!this.authService.isAdmin()) {\n      this.router.navigate(['/events']);\n      return;\n    }\n    // Induló adatbetöltés\n    this.loadDashboardData();\n    // Figyeljük a navigációt, és újratöltjük az adatokat, amikor visszatérünk a dashboard oldalra\n    this.routerSubscription = this.router.events.pipe(filter(event => event instanceof NavigationEnd)).subscribe(event => {\n      if (event.url === '/admin/dashboard') {\n        console.log('Navigáció a dashboard oldalra, adatok frissítése...');\n        this.loadDashboardData();\n      }\n    });\n    // Automatikus frissítés 10 másodpercenként, hogy hamarabb lássuk az új jegyeket\n    this.refreshSubscription = interval(10000).subscribe(() => {\n      console.log('Automatikus frissítés a dashboardon...');\n      this.loadTicketData();\n    });\n    // Figyelés a jegyvásárlási eseményekre is, hogy azonnal frissülön az adat\n    // Ez egy subscribe az Angular route events-re, ami a jegyvásárlás után történik\n    this.router.events.pipe(filter(event => event instanceof NavigationEnd), filter(event => {\n      // Jegyvásárlás vagy jegy kezelés után frissítsünk\n      const purchaseUrl = event.url.includes('/purchase');\n      const ticketsUrl = event.url.includes('/tickets');\n      const returningToDashboard = event.url.includes('/admin/dashboard');\n      return purchaseUrl || ticketsUrl || returningToDashboard;\n    })).subscribe(() => {\n      console.log('Jegyvásárlás vagy jegy művelet utáni frissítés...');\n      // 1 másodperc késleltetéssel frissítsünk, hogy a backend-nek legyen ideje feldolgozni\n      setTimeout(() => this.loadDashboardData(), 1000);\n    });\n  }\n  /**\n   * Komponens megsemmisítésekor leiratkozunk az aktív feliratkozásokról\n   */\n  ngOnDestroy() {\n    if (this.refreshSubscription) {\n      this.refreshSubscription.unsubscribe();\n      this.refreshSubscription = null;\n    }\n    if (this.routerSubscription) {\n      this.routerSubscription.unsubscribe();\n      this.routerSubscription = null;\n    }\n  }\n  loadDashboardData() {\n    this.loading = true;\n    // Események betöltése\n    this.eventService.getEvents().subscribe({\n      next: events => {\n        this.events = events;\n        this.totalEvents = events.length;\n        this.calculateEventsByMonth();\n        // Jegyek betöltése események után\n        this.loadTicketData();\n      },\n      error: err => {\n        this.error = 'Hiba történt az események betöltése közben.';\n        this.loading = false;\n        console.error('Error loading events:', err);\n      }\n    });\n  }\n  loadTicketData() {\n    console.log('Jegyek frissítése - legfrissebb adatok lekérése a szerverről...');\n    // API hívás előtt jegyezzük fel az utolsó jegyszámot, hogy lássuk, van-e változás\n    const previousTicketCount = this.totalActiveTickets;\n    // Ellenőrizzük az admin jogosultságokat és a tokent a kérés előtt\n    const token = this.authService.getToken();\n    console.log('Bejelentkezési állapot ellenőrzése:', {\n      isLoggedIn: this.authService.isAuthenticated(),\n      isAdmin: this.authService.isAdmin(),\n      hasToken: !!token,\n      tokenPreview: token ? `${token.substring(0, 15)}...` : 'nincs token'\n    });\n    // Kérjük a ticketeket, timestamp-pel a biztos frissítéshez\n    this.ticketService.getAllTickets(true).subscribe({\n      next: tickets => {\n        if (!tickets || !Array.isArray(tickets)) {\n          this.error = 'Hiba történt a jegyek betöltése közben: Érvénytelen adatformátum';\n          this.loading = false;\n          return;\n        }\n        this.tickets = tickets;\n        this.totalTickets = tickets.length;\n        // A Ticket modellben a státusz típusai: 'pending' | 'confirmed' | 'cancelled'\n        this.totalActiveTickets = tickets.filter(t => t.status === 'confirmed' || t.status === 'pending').length;\n        this.totalCancelledTickets = tickets.filter(t => t.status === 'cancelled').length;\n        // Számítsuk ki az összbevételt\n        this.totalSales = tickets.filter(t => t.status !== 'cancelled').reduce((sum, ticket) => {\n          // Biztonságos ár konverzió - a price érték lehet undefined vagy number típus\n          const price = typeof ticket.price === 'number' ? ticket.price : 0;\n          return sum + price;\n        }, 0);\n        this.calculateTicketsByCategory();\n        this.loading = false;\n        this.error = null; // Töröljük a hibát, ha sikeres a betöltés\n        // Ellenőrizzük, változott-e a jegyek száma az előző betöltés óta\n        if (previousTicketCount !== this.totalActiveTickets) {\n          console.log(`Jegyek száma változott: ${previousTicketCount} -> ${this.totalActiveTickets}`);\n        }\n      },\n      error: err => {\n        this.error = 'Hiba történt a jegyek betöltése közben.';\n        this.loading = false;\n        console.error('Error loading tickets:', err);\n      }\n    });\n  }\n  /**\n   * Események havi eloszlásának számítása\n   */\n  calculateEventsByMonth() {\n    this.monthlyEventCounts = Array(12).fill(0);\n    this.events.forEach(event => {\n      if (event.date) {\n        const month = new Date(event.date).getMonth();\n        this.monthlyEventCounts[month]++;\n      }\n    });\n  }\n  /**\n   * Jegyek kategoriánkénti eloszlásának számítása\n   */\n  calculateTicketsByCategory() {\n    // Jegyek és bevételek kategóriánként\n    const categoryData = new Map();\n    this.tickets.forEach(ticket => {\n      // Ha nincs kategória, \"Ismeretlen\" kategóriába soroljuk\n      const category = ticket.category || 'Ismeretlen';\n      if (ticket.status !== 'cancelled') {\n        const categoryInfo = categoryData.get(category) || {\n          count: 0,\n          revenue: 0\n        };\n        categoryInfo.count += 1;\n        // Biztonságos ár konverzió\n        let ticketPrice = 0;\n        if (ticket.price !== undefined && ticket.price !== null) {\n          ticketPrice = typeof ticket.price === 'number' ? ticket.price : 0;\n        }\n        categoryInfo.revenue += ticketPrice;\n        categoryData.set(category, categoryInfo);\n      }\n    });\n    this.ticketCategories = Array.from(categoryData.entries()).map(([name, data]) => ({\n      name,\n      count: data.count,\n      revenue: data.revenue\n    }))\n    // Rendezzük csökkenő sorrend szerint a jegyek száma alapján\n    .sort((a, b) => b.count - a.count);\n  }\n  /**\n   * Adott hónapban lévő események száma\n   */\n  getEventCountByMonth(monthIndex) {\n    return this.monthlyEventCounts[monthIndex] || 0;\n  }\n  /**\n   * Jegy kategóriák listájának lekérése\n   */\n  getTicketCategories() {\n    return this.ticketCategories;\n  }\n  /**\n   * Dátum formázása\n   */\n  formatDate(dateString) {\n    if (!dateString) return '';\n    const date = new Date(dateString);\n    return date.toLocaleString('hu-HU', {\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  }\n  /**\n   * Navigáció az események oldalra\n   */\n  navigateToEvents() {\n    this.router.navigate(['/events']);\n  }\n  /**\n   * Esemény szerkesztése\n   */\n  editEvent(eventId) {\n    this.router.navigate(['/events', eventId, 'edit']);\n  }\n  /**\n   * Esemény megtekintése\n   */\n  viewEvent(eventId) {\n    this.router.navigate(['/events', eventId]);\n  }\n  /**\n   * Kiszámolja egy eseményhez elérhető összes jegy számát\n   * @param event Az esemény, amihez az elérhető jegyeket számoljuk\n   * @returns Az elérhető jegyek száma\n   */\n  getAvailableTickets(event) {\n    if (!event || !event.ticketCategories) return 0;\n    // Összegezzük a kategóriánként elérhető helyeket\n    return event.ticketCategories.reduce((sum, category) => {\n      return sum + (category.availableSeats || 0);\n    }, 0);\n  }\n  static {\n    this.ɵfac = function DashboardComponent_Factory(t) {\n      return new (t || DashboardComponent)(i0.ɵɵdirectiveInject(i1.EventService), i0.ɵɵdirectiveInject(i2.TicketService), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i4.Router));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: DashboardComponent,\n      selectors: [[\"app-dashboard\"]],\n      decls: 11,\n      vars: 5,\n      consts: [[1, \"container-fluid\", \"mt-4\"], [1, \"row\"], [1, \"col-12\"], [1, \"dashboard-title\"], [1, \"fas\", \"fa-chart-line\", \"me-2\"], [\"class\", \"text-center p-5\", 4, \"ngIf\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [\"class\", \"row mt-4\", 4, \"ngIf\"], [1, \"text-center\", \"p-5\"], [\"role\", \"status\", 1, \"spinner-border\", \"text-primary\"], [1, \"visually-hidden\"], [1, \"mt-3\"], [1, \"alert\", \"alert-danger\"], [1, \"row\", \"mt-4\"], [1, \"col-lg-4\", \"mb-4\"], [1, \"card\", \"stat-card\", \"bg-primary\", \"text-white\", \"h-100\"], [1, \"card-body\"], [1, \"row\", \"align-items-center\"], [1, \"col-3\"], [1, \"fas\", \"fa-calendar\", \"fa-3x\"], [1, \"col-9\", \"text-end\"], [1, \"card\", \"stat-card\", \"bg-success\", \"text-white\", \"h-100\"], [1, \"fas\", \"fa-ticket-alt\", \"fa-3x\"], [1, \"card\", \"stat-card\", \"bg-info\", \"text-white\", \"h-100\"], [1, \"fas\", \"fa-money-bill-wave\", \"fa-3x\"], [1, \"col-xl-6\", \"mb-4\"], [1, \"card\", \"chart-card\", \"h-100\"], [1, \"card-header\"], [1, \"card-title\"], [1, \"fas\", \"fa-chart-bar\", \"me-2\"], [1, \"table-responsive\"], [1, \"table\", \"table-striped\"], [4, \"ngFor\", \"ngForOf\"], [1, \"card\", \"h-100\"], [1, \"fas\", \"fa-list\", \"me-2\"], [1, \"table\", \"table-hover\"], [4, \"ngIf\"], [1, \"card-footer\", \"d-flex\", \"justify-content-end\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"btn\", \"btn-sm\", \"btn-warning\", \"me-1\", 3, \"click\"], [1, \"fas\", \"fa-edit\"], [1, \"btn\", \"btn-sm\", \"btn-info\", 3, \"click\"], [1, \"fas\", \"fa-eye\"], [\"colspan\", \"4\", 1, \"text-center\"], [1, \"col-12\", \"mb-4\"], [1, \"fas\", \"fa-chart-pie\", \"me-2\"], [\"colspan\", \"3\", 1, \"text-center\"]],\n      template: function DashboardComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h2\", 3);\n          i0.ɵɵelement(4, \"i\", 4);\n          i0.ɵɵtext(5, \"Admin Vez\\u00E9rl\\u0151pult \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(6, DashboardComponent_div_6_Template, 6, 0, \"div\", 5);\n          i0.ɵɵtemplate(7, DashboardComponent_div_7_Template, 2, 1, \"div\", 6);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(8, DashboardComponent_div_8_Template, 34, 3, \"div\", 7);\n          i0.ɵɵtemplate(9, DashboardComponent_div_9_Template, 43, 4, \"div\", 7);\n          i0.ɵɵtemplate(10, DashboardComponent_div_10_Template, 21, 2, \"div\", 7);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.error);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading);\n        }\n      },\n      dependencies: [i5.NgForOf, i5.NgIf],\n      styles: [\".dashboard-title[_ngcontent-%COMP%] {\\n  color: #2c3e50;\\n  margin-bottom: 1.5rem;\\n  font-weight: 700;\\n  border-bottom: 2px solid #3498db;\\n  padding-bottom: 0.5rem;\\n}\\n\\n.stat-card[_ngcontent-%COMP%] {\\n  border: none;\\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);\\n  transition: all 0.3s ease;\\n  height: 100%;\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n.stat-card[_ngcontent-%COMP%]:hover {\\n  transform: translateY(-5px);\\n  box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);\\n}\\n\\n.stat-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%] {\\n  padding: 1.25rem;\\n  flex: 1;\\n  display: flex;\\n  align-items: center;\\n}\\n\\n.stat-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\\n  font-size: 2rem;\\n  font-weight: 700;\\n  margin-bottom: 0;\\n  min-height: 44px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: flex-end;\\n  width: 100%;\\n}\\n\\n.stat-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%] {\\n  background: rgba(0, 0, 0, 0.1);\\n  border-top: none;\\n  padding: 0.75rem 1.25rem;\\n}\\n\\n.stat-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\\n  text-decoration: none;\\n  font-weight: 500;\\n}\\n\\n.chart-card[_ngcontent-%COMP%] {\\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);\\n  border: none;\\n  border-radius: 10px;\\n}\\n\\n.chart-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%] {\\n  background-color: #fff;\\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\\n  padding: 1rem 1.25rem;\\n}\\n\\n.chart-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%] {\\n  margin-bottom: 0;\\n  color: #2c3e50;\\n  font-weight: 600;\\n}\\n\\n.chart-container[_ngcontent-%COMP%] {\\n  position: relative;\\n  width: 100%;\\n}\\n\\n.table[_ngcontent-%COMP%] {\\n  margin-bottom: 0;\\n}\\n\\n.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\\n  border-top: none;\\n  font-weight: 600;\\n  color: #2c3e50;\\n}\\n\\n.btn-sm[_ngcontent-%COMP%] {\\n  padding: 0.25rem 0.5rem;\\n  font-size: 0.75rem;\\n}\\n\\n@media (max-width: 768px) {\\n  .stat-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\\n    font-size: 1.5rem;\\n  }\\n}\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9hZG1pbi9kYXNoYm9hcmQvZGFzaGJvYXJkLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxjQUFjO0VBQ2QscUJBQXFCO0VBQ3JCLGdCQUFnQjtFQUNoQixnQ0FBZ0M7RUFDaEMsc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UsWUFBWTtFQUNaLHlDQUF5QztFQUN6Qyx5QkFBeUI7RUFDekIsWUFBWTtFQUNaLGFBQWE7RUFDYixzQkFBc0I7QUFDeEI7O0FBRUE7RUFDRSwyQkFBMkI7RUFDM0IseUNBQXlDO0FBQzNDOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLE9BQU87RUFDUCxhQUFhO0VBQ2IsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsZUFBZTtFQUNmLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsZ0JBQWdCO0VBQ2hCLGFBQWE7RUFDYixtQkFBbUI7RUFDbkIseUJBQXlCO0VBQ3pCLFdBQVc7QUFDYjs7QUFFQTtFQUNFLDhCQUE4QjtFQUM5QixnQkFBZ0I7RUFDaEIsd0JBQXdCO0FBQzFCOztBQUVBO0VBQ0UscUJBQXFCO0VBQ3JCLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLDBDQUEwQztFQUMxQyxZQUFZO0VBQ1osbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0Usc0JBQXNCO0VBQ3RCLDRDQUE0QztFQUM1QyxxQkFBcUI7QUFDdkI7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsY0FBYztFQUNkLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsZ0JBQWdCO0VBQ2hCLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSx1QkFBdUI7RUFDdkIsa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0U7SUFDRSxpQkFBaUI7RUFDbkI7QUFDRiIsInNvdXJjZXNDb250ZW50IjpbIi5kYXNoYm9hcmQtdGl0bGUge1xuICBjb2xvcjogIzJjM2U1MDtcbiAgbWFyZ2luLWJvdHRvbTogMS41cmVtO1xuICBmb250LXdlaWdodDogNzAwO1xuICBib3JkZXItYm90dG9tOiAycHggc29saWQgIzM0OThkYjtcbiAgcGFkZGluZy1ib3R0b206IDAuNXJlbTtcbn1cblxuLnN0YXQtY2FyZCB7XG4gIGJvcmRlcjogbm9uZTtcbiAgYm94LXNoYWRvdzogMCA0cHggMTBweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7XG4gIGhlaWdodDogMTAwJTtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbn1cblxuLnN0YXQtY2FyZDpob3ZlciB7XG4gIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNXB4KTtcbiAgYm94LXNoYWRvdzogMCA4cHggMTVweCByZ2JhKDAsIDAsIDAsIDAuMik7XG59XG5cbi5zdGF0LWNhcmQgLmNhcmQtYm9keSB7XG4gIHBhZGRpbmc6IDEuMjVyZW07XG4gIGZsZXg6IDE7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG59XG5cbi5zdGF0LWNhcmQgaDMge1xuICBmb250LXNpemU6IDJyZW07XG4gIGZvbnQtd2VpZ2h0OiA3MDA7XG4gIG1hcmdpbi1ib3R0b206IDA7XG4gIG1pbi1oZWlnaHQ6IDQ0cHg7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4uc3RhdC1jYXJkIC5jYXJkLWZvb3RlciB7XG4gIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgYm9yZGVyLXRvcDogbm9uZTtcbiAgcGFkZGluZzogMC43NXJlbSAxLjI1cmVtO1xufVxuXG4uc3RhdC1jYXJkIC5jYXJkLWZvb3RlciBhIHtcbiAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xuICBmb250LXdlaWdodDogNTAwO1xufVxuXG4uY2hhcnQtY2FyZCB7XG4gIGJveC1zaGFkb3c6IDAgNHB4IDEwcHggcmdiYSgwLCAwLCAwLCAwLjA1KTtcbiAgYm9yZGVyOiBub25lO1xuICBib3JkZXItcmFkaXVzOiAxMHB4O1xufVxuXG4uY2hhcnQtY2FyZCAuY2FyZC1oZWFkZXIge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xuICBib3JkZXItYm90dG9tOiAxcHggc29saWQgcmdiYSgwLCAwLCAwLCAwLjA1KTtcbiAgcGFkZGluZzogMXJlbSAxLjI1cmVtO1xufVxuXG4uY2hhcnQtY2FyZCAuY2FyZC10aXRsZSB7XG4gIG1hcmdpbi1ib3R0b206IDA7XG4gIGNvbG9yOiAjMmMzZTUwO1xuICBmb250LXdlaWdodDogNjAwO1xufVxuXG4uY2hhcnQtY29udGFpbmVyIHtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICB3aWR0aDogMTAwJTtcbn1cblxuLnRhYmxlIHtcbiAgbWFyZ2luLWJvdHRvbTogMDtcbn1cblxuLnRhYmxlIHRoIHtcbiAgYm9yZGVyLXRvcDogbm9uZTtcbiAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgY29sb3I6ICMyYzNlNTA7XG59XG5cbi5idG4tc20ge1xuICBwYWRkaW5nOiAwLjI1cmVtIDAuNXJlbTtcbiAgZm9udC1zaXplOiAwLjc1cmVtO1xufVxuXG5AbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHtcbiAgLnN0YXQtY2FyZCBoMyB7XG4gICAgZm9udC1zaXplOiAxLjVyZW07XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n    });\n  }\n}","map":{"version":3,"names":["NavigationEnd","interval","filter","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate1","ctx_r1","error","ɵɵelement","ɵɵtextInterpolate","ctx_r2","totalEvents","totalActiveTickets","totalSales","month_r8","ctx_r5","getEventCountByMonth","i_r9","ɵɵlistener","DashboardComponent_div_9_tr_38_Template_button_click_8_listener","restoredCtx","ɵɵrestoreView","_r12","event_r10","$implicit","ctx_r11","ɵɵnextContext","ɵɵresetView","editEvent","_id","DashboardComponent_div_9_tr_38_Template_button_click_10_listener","ctx_r13","viewEvent","title","ctx_r6","formatDate","date","getAvailableTickets","ɵɵtemplate","DashboardComponent_div_9_tr_17_Template","DashboardComponent_div_9_tr_38_Template","DashboardComponent_div_9_tr_39_Template","DashboardComponent_div_9_Template_button_click_41_listener","_r15","ctx_r14","navigateToEvents","ɵɵproperty","ɵɵpureFunction0","_c0","ctx_r3","events","slice","length","category_r18","name","count","revenue","DashboardComponent_div_10_tr_19_Template","DashboardComponent_div_10_tr_20_Template","ctx_r4","getTicketCategories","DashboardComponent","constructor","eventService","ticketService","authService","router","tickets","loading","totalTickets","totalCancelledTickets","eventsByMonth","ticketsByCategory","monthlyEventCounts","ticketCategories","refreshSubscription","routerSubscription","lastTicketCount","ngOnInit","isAdmin","navigate","loadDashboardData","pipe","event","subscribe","url","console","log","loadTicketData","purchaseUrl","includes","ticketsUrl","returningToDashboard","setTimeout","ngOnDestroy","unsubscribe","getEvents","next","calculateEventsByMonth","err","previousTicketCount","token","getToken","isLoggedIn","isAuthenticated","hasToken","tokenPreview","substring","getAllTickets","Array","isArray","t","status","reduce","sum","ticket","price","calculateTicketsByCategory","fill","forEach","month","Date","getMonth","categoryData","Map","category","categoryInfo","get","ticketPrice","undefined","set","from","entries","map","data","sort","a","b","monthIndex","dateString","toLocaleString","year","day","hour","minute","eventId","availableSeats","ɵɵdirectiveInject","i1","EventService","i2","TicketService","i3","AuthService","i4","Router","selectors","decls","vars","consts","template","DashboardComponent_Template","rf","ctx","DashboardComponent_div_6_Template","DashboardComponent_div_7_Template","DashboardComponent_div_8_Template","DashboardComponent_div_9_Template","DashboardComponent_div_10_Template"],"sources":["D:\\SZTE_PROGINFO\\programrendszerek_fejlesztese\\TicketPortal\\frontend\\src\\app\\components\\admin\\dashboard\\dashboard.component.ts","D:\\SZTE_PROGINFO\\programrendszerek_fejlesztese\\TicketPortal\\frontend\\src\\app\\components\\admin\\dashboard\\dashboard.component.html"],"sourcesContent":["import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { EventService } from '../../../services/event.service';\nimport { TicketService } from '../../../services/ticket.service';\nimport { AuthService } from '../../../services/auth.service';\nimport { Router, NavigationEnd } from '@angular/router';\nimport { Event } from '../../../models/event.model';\nimport { Ticket } from '../../../models/ticket.model';\nimport { interval, Subscription } from 'rxjs';\nimport { filter } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-dashboard',\n  templateUrl: './dashboard.component.html',\n  styleUrls: ['./dashboard.component.css']\n})\nexport class DashboardComponent implements OnInit, OnDestroy {\n  events: Event[] = [];\n  tickets: Ticket[] = [];\n  loading = true;\n  error: string | null = null;\n  \n  // Statisztikai adatok\n  totalEvents = 0;\n  totalTickets = 0;\n  totalSales = 0;\n  totalActiveTickets = 0;\n  totalCancelledTickets = 0;\n  eventsByMonth: any[] = [];\n  ticketsByCategory: any[] = [];\n  \n  // Hónapi események száma\n  monthlyEventCounts: number[] = [];\n  \n  // Jegy kategóriák és statisztikák\n  ticketCategories: { name: string, count: number, revenue: number }[] = [];\n  \n  // Automatikus frissítés és útvonal figyelelés\n  private refreshSubscription: Subscription | null = null;\n  private routerSubscription: Subscription | null = null;\n  private lastTicketCount = 0; // Utóbbi jegyszám összehasonlításhoz\n  \n  constructor(\n    private eventService: EventService,\n    private ticketService: TicketService,\n    private authService: AuthService,\n    private router: Router\n  ) {}\n\n  ngOnInit(): void {\n    if (!this.authService.isAdmin()) {\n      this.router.navigate(['/events']);\n      return;\n    }\n    \n    // Induló adatbetöltés\n    this.loadDashboardData();\n    \n    // Figyeljük a navigációt, és újratöltjük az adatokat, amikor visszatérünk a dashboard oldalra\n    this.routerSubscription = this.router.events.pipe(\n      filter(event => event instanceof NavigationEnd)\n    ).subscribe((event: any) => {\n      if (event.url === '/admin/dashboard') {\n        console.log('Navigáció a dashboard oldalra, adatok frissítése...');\n        this.loadDashboardData();\n      }\n    });\n    \n    // Automatikus frissítés 10 másodpercenként, hogy hamarabb lássuk az új jegyeket\n    this.refreshSubscription = interval(10000).subscribe(() => {\n      console.log('Automatikus frissítés a dashboardon...');\n      this.loadTicketData();\n    });\n    \n    // Figyelés a jegyvásárlási eseményekre is, hogy azonnal frissülön az adat\n    // Ez egy subscribe az Angular route events-re, ami a jegyvásárlás után történik\n    this.router.events.pipe(\n      filter(event => event instanceof NavigationEnd),\n      filter((event: any) => {\n        // Jegyvásárlás vagy jegy kezelés után frissítsünk\n        const purchaseUrl = event.url.includes('/purchase');\n        const ticketsUrl = event.url.includes('/tickets');\n        const returningToDashboard = event.url.includes('/admin/dashboard');\n        return purchaseUrl || ticketsUrl || returningToDashboard;\n      })\n    ).subscribe(() => {\n      console.log('Jegyvásárlás vagy jegy művelet utáni frissítés...');\n      // 1 másodperc késleltetéssel frissítsünk, hogy a backend-nek legyen ideje feldolgozni\n      setTimeout(() => this.loadDashboardData(), 1000);\n    });\n  }\n  \n  /**\n   * Komponens megsemmisítésekor leiratkozunk az aktív feliratkozásokról\n   */\n  ngOnDestroy(): void {\n    if (this.refreshSubscription) {\n      this.refreshSubscription.unsubscribe();\n      this.refreshSubscription = null;\n    }\n    \n    if (this.routerSubscription) {\n      this.routerSubscription.unsubscribe();\n      this.routerSubscription = null;\n    }\n  }\n  \n  loadDashboardData(): void {\n    this.loading = true;\n    \n    // Események betöltése\n    this.eventService.getEvents().subscribe({\n      next: (events) => {\n        this.events = events;\n        this.totalEvents = events.length;\n        this.calculateEventsByMonth();\n        \n        // Jegyek betöltése események után\n        this.loadTicketData();\n      },\n      error: (err) => {\n        this.error = 'Hiba történt az események betöltése közben.';\n        this.loading = false;\n        console.error('Error loading events:', err);\n      }\n    });\n  }\n  \n  loadTicketData(): void {\n    console.log('Jegyek frissítése - legfrissebb adatok lekérése a szerverről...');\n    // API hívás előtt jegyezzük fel az utolsó jegyszámot, hogy lássuk, van-e változás\n    const previousTicketCount = this.totalActiveTickets;\n    \n    // Ellenőrizzük az admin jogosultságokat és a tokent a kérés előtt\n    const token = this.authService.getToken();\n    console.log('Bejelentkezési állapot ellenőrzése:', {\n      isLoggedIn: this.authService.isAuthenticated(),\n      isAdmin: this.authService.isAdmin(),\n      hasToken: !!token,\n      tokenPreview: token ? `${token.substring(0, 15)}...` : 'nincs token'\n    });\n    \n    // Kérjük a ticketeket, timestamp-pel a biztos frissítéshez\n    this.ticketService.getAllTickets(true).subscribe({\n      next: (tickets: Ticket[]) => {\n        if (!tickets || !Array.isArray(tickets)) {\n          this.error = 'Hiba történt a jegyek betöltése közben: Érvénytelen adatformátum';\n          this.loading = false;\n          return;\n        }\n        \n        this.tickets = tickets;\n        this.totalTickets = tickets.length;\n        // A Ticket modellben a státusz típusai: 'pending' | 'confirmed' | 'cancelled'\n        this.totalActiveTickets = tickets.filter((t: Ticket) => t.status === 'confirmed' || t.status === 'pending').length;\n        this.totalCancelledTickets = tickets.filter((t: Ticket) => t.status === 'cancelled').length;\n        \n        // Számítsuk ki az összbevételt\n        this.totalSales = tickets\n          .filter((t: Ticket) => t.status !== 'cancelled')\n          .reduce((sum: number, ticket: Ticket) => {\n            // Biztonságos ár konverzió - a price érték lehet undefined vagy number típus\n            const price = typeof ticket.price === 'number' ? ticket.price : 0;\n            return sum + price;\n          }, 0);\n        \n        this.calculateTicketsByCategory();\n        \n        this.loading = false;\n        this.error = null; // Töröljük a hibát, ha sikeres a betöltés\n        \n        // Ellenőrizzük, változott-e a jegyek száma az előző betöltés óta\n        if (previousTicketCount !== this.totalActiveTickets) {\n          console.log(`Jegyek száma változott: ${previousTicketCount} -> ${this.totalActiveTickets}`);\n        }\n      },\n      error: (err: any) => {\n        this.error = 'Hiba történt a jegyek betöltése közben.';\n        this.loading = false;\n        console.error('Error loading tickets:', err);\n      }\n    });\n  }\n  \n  /**\n   * Események havi eloszlásának számítása\n   */\n  calculateEventsByMonth(): void {\n    this.monthlyEventCounts = Array(12).fill(0);\n    \n    this.events.forEach(event => {\n      if (event.date) {\n        const month = new Date(event.date).getMonth();\n        this.monthlyEventCounts[month]++;\n      }\n    });\n  }\n  \n  /**\n   * Jegyek kategoriánkénti eloszlásának számítása\n   */\n  calculateTicketsByCategory(): void {\n    // Jegyek és bevételek kategóriánként\n    const categoryData = new Map<string, { count: number, revenue: number }>();\n    \n    this.tickets.forEach((ticket: Ticket) => {\n      // Ha nincs kategória, \"Ismeretlen\" kategóriába soroljuk\n      const category = ticket.category || 'Ismeretlen';\n      \n      if (ticket.status !== 'cancelled') {\n        const categoryInfo = categoryData.get(category) || { count: 0, revenue: 0 };\n        categoryInfo.count += 1;\n        \n        // Biztonságos ár konverzió\n        let ticketPrice = 0;\n        if (ticket.price !== undefined && ticket.price !== null) {\n          ticketPrice = typeof ticket.price === 'number' ? ticket.price : 0;\n        }\n        \n        categoryInfo.revenue += ticketPrice;\n        categoryData.set(category, categoryInfo);\n      }\n    });\n    \n    this.ticketCategories = Array.from(categoryData.entries())\n      .map(([name, data]) => ({\n        name,\n        count: data.count,\n        revenue: data.revenue\n      }))\n      // Rendezzük csökkenő sorrend szerint a jegyek száma alapján\n      .sort((a, b) => b.count - a.count);\n  }\n  \n  /**\n   * Adott hónapban lévő események száma\n   */\n  getEventCountByMonth(monthIndex: number): number {\n    return this.monthlyEventCounts[monthIndex] || 0;\n  }\n  \n  /**\n   * Jegy kategóriák listájának lekérése\n   */\n  getTicketCategories(): { name: string, count: number, revenue: number }[] {\n    return this.ticketCategories;\n  }\n  \n  /**\n   * Dátum formázása\n   */\n  formatDate(dateString: string): string {\n    if (!dateString) return '';\n    const date = new Date(dateString);\n    return date.toLocaleString('hu-HU', { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' });\n  }\n  \n  /**\n   * Navigáció az események oldalra\n   */\n  navigateToEvents(): void {\n    this.router.navigate(['/events']);\n  }\n  \n  /**\n   * Esemény szerkesztése\n   */\n  editEvent(eventId: string): void {\n    this.router.navigate(['/events', eventId, 'edit']);\n  }\n  \n  /**\n   * Esemény megtekintése\n   */\n  viewEvent(eventId: string): void {\n    this.router.navigate(['/events', eventId]);\n  }\n  \n  /**\n   * Kiszámolja egy eseményhez elérhető összes jegy számát\n   * @param event Az esemény, amihez az elérhető jegyeket számoljuk\n   * @returns Az elérhető jegyek száma\n   */\n  getAvailableTickets(event: Event): number {\n    if (!event || !event.ticketCategories) return 0;\n    \n    // Összegezzük a kategóriánként elérhető helyeket\n    return event.ticketCategories.reduce((sum, category) => {\n      return sum + (category.availableSeats || 0);\n    }, 0);\n  }\n}\n","<div class=\"container-fluid mt-4\">\n  <div class=\"row\">\n    <div class=\"col-12\">\n      <h2 class=\"dashboard-title\">\n        <i class=\"fas fa-chart-line me-2\"></i>Admin Vezérlőpult\n      </h2>\n      \n      <!-- Töltési állapot -->\n      <div *ngIf=\"loading\" class=\"text-center p-5\">\n        <div class=\"spinner-border text-primary\" role=\"status\">\n          <span class=\"visually-hidden\">Loading...</span>\n        </div>\n        <p class=\"mt-3\">Adatok betöltése...</p>\n      </div>\n      \n      <!-- Hiba üzenet -->\n      <div *ngIf=\"error\" class=\"alert alert-danger\">\n        {{ error }}\n      </div>\n    </div>\n  </div>\n  \n  <!-- Statisztikai kártyák -->\n  <div *ngIf=\"!loading\" class=\"row mt-4\">\n    <div class=\"col-lg-4 mb-4\">\n      <div class=\"card stat-card bg-primary text-white h-100\">\n        <div class=\"card-body\">\n          <div class=\"row align-items-center\">\n            <div class=\"col-3\">\n              <i class=\"fas fa-calendar fa-3x\"></i>\n            </div>\n            <div class=\"col-9 text-end\">\n              <h3>{{ totalEvents || \"0\" }}</h3>\n              <div>Esemény</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"col-lg-4 mb-4\">\n      <div class=\"card stat-card bg-success text-white h-100\">\n        <div class=\"card-body\">\n          <div class=\"row align-items-center\">\n            <div class=\"col-3\">\n              <i class=\"fas fa-ticket-alt fa-3x\"></i>\n            </div>\n            <div class=\"col-9 text-end\">\n              <h3>{{ totalActiveTickets || \"0\" }}</h3>\n              <div>Megvásárolt jegyek</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"col-lg-4 mb-4\">\n      <div class=\"card stat-card bg-info text-white h-100\">\n        <div class=\"card-body\">\n          <div class=\"row align-items-center\">\n            <div class=\"col-3\">\n              <i class=\"fas fa-money-bill-wave fa-3x\"></i>\n            </div>\n            <div class=\"col-9 text-end\">\n              <h3>{{ (totalSales || \"0\") + \" Ft\" }}</h3>\n              <div>Összes bevétel</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n\n  </div>\n  \n  <!-- Statisztikai adatok egyszerűsített megjelenítése -->\n  <div *ngIf=\"!loading\" class=\"row mt-4\">\n    <div class=\"col-xl-6 mb-4\">\n      <div class=\"card chart-card h-100\">\n        <div class=\"card-header\">\n          <h5 class=\"card-title\">\n            <i class=\"fas fa-chart-bar me-2\"></i>Események havi eloszlása\n          </h5>\n        </div>\n        <div class=\"card-body\">\n          <div class=\"table-responsive\">\n            <table class=\"table table-striped\">\n              <thead>\n                <tr>\n                  <th>Hónap</th>\n                  <th>Események száma</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let month of ['Január', 'Február', 'Március', 'Április', 'Május', 'Június', 'Július', 'Augusztus', 'Szeptember', 'Október', 'November', 'December']; let i = index\">\n                  <td>{{ month }}</td>\n                  <td>{{ getEventCountByMonth(i) }}</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"col-xl-6 mb-4\">\n      <div class=\"card h-100\">\n        <div class=\"card-header\">\n          <h5 class=\"card-title\">\n            <i class=\"fas fa-list me-2\"></i>Legközelebbi események\n          </h5>\n        </div>\n        <div class=\"card-body\">\n          <div class=\"table-responsive\">\n            <table class=\"table table-hover\">\n              <thead>\n                <tr>\n                  <th>Esemény</th>\n                  <th>Dátum</th>\n                  <th>Elérhető jegyek</th>\n                  <th>Műveletek</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let event of events.slice(0, 5)\">\n                  <td>{{ event.title }}</td>\n                  <td>{{ formatDate(event.date) }}</td>\n                  <td>{{ getAvailableTickets(event) }}</td>\n                  <td>\n                    <button class=\"btn btn-sm btn-warning me-1\" (click)=\"editEvent(event._id)\">\n                      <i class=\"fas fa-edit\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-info\" (click)=\"viewEvent(event._id)\">\n                      <i class=\"fas fa-eye\"></i>\n                    </button>\n                  </td>\n                </tr>\n                <tr *ngIf=\"events.length === 0\">\n                  <td colspan=\"4\" class=\"text-center\">Nincs megjeleníthető esemény</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n        <div class=\"card-footer d-flex justify-content-end\">\n          <button class=\"btn btn-primary\" (click)=\"navigateToEvents()\">Összes esemény</button>\n        </div>\n      </div>\n    </div>\n  </div>\n  \n  <!-- Jegyek kategóriánként -->\n  <div *ngIf=\"!loading\" class=\"row mt-4\">\n    <div class=\"col-12 mb-4\">\n      <div class=\"card chart-card h-100\">\n        <div class=\"card-header\">\n          <h5 class=\"card-title\">\n            <i class=\"fas fa-chart-pie me-2\"></i>Jegyek kategóriánként\n          </h5>\n        </div>\n        <div class=\"card-body\">\n          <div class=\"table-responsive\">\n            <table class=\"table table-striped\">\n              <thead>\n                <tr>\n                  <th>Kategória</th>\n                  <th>Jegyek száma</th>\n                  <th>Bevétel (Ft)</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let category of getTicketCategories()\">\n                  <td>{{ category.name }}</td>\n                  <td>{{ category.count }}</td>\n                  <td>{{ category.revenue }} Ft</td>\n                </tr>\n                <tr *ngIf=\"getTicketCategories().length === 0\">\n                  <td colspan=\"3\" class=\"text-center\">Nincs megjeleníthető adat</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}