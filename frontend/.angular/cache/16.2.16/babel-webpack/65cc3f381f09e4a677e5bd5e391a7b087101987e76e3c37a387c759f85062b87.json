{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../../../services/event.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nfunction EventFormComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1, \" A c\\u00EDm megad\\u00E1sa k\\u00F6telez\\u0151 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventFormComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1, \" A le\\u00EDr\\u00E1s megad\\u00E1sa k\\u00F6telez\\u0151 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventFormComponent_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1, \" A d\\u00E1tum megad\\u00E1sa k\\u00F6telez\\u0151 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventFormComponent_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1, \" A helysz\\u00EDn megad\\u00E1sa k\\u00F6telez\\u0151 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventFormComponent_div_39_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1, \" A n\\u00E9v megad\\u00E1sa k\\u00F6telez\\u0151 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventFormComponent_div_39_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1, \" Az \\u00E1r megad\\u00E1sa k\\u00F6telez\\u0151 \\u00E9s nem lehet negat\\u00EDv \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventFormComponent_div_39_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1, \" Az el\\u00E9rhet\\u0151 jegyek sz\\u00E1m\\u00E1nak megad\\u00E1sa k\\u00F6telez\\u0151 \\u00E9s nem lehet negat\\u00EDv \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventFormComponent_div_39_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 28)(1, \"div\", 6)(2, \"div\", 21)(3, \"h5\", 29);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function EventFormComponent_div_39_Template_button_click_5_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const i_r6 = restoredCtx.index;\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.removeTicketCategory(i_r6));\n    });\n    i0.ɵɵtext(6, \" T\\u00F6rl\\u00E9s \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 8)(8, \"label\", 31);\n    i0.ɵɵtext(9, \"N\\u00E9v\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"input\", 32);\n    i0.ɵɵtemplate(11, EventFormComponent_div_39_div_11_Template, 2, 0, \"div\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\", 8)(13, \"label\", 31);\n    i0.ɵɵtext(14, \"\\u00C1r\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(15, \"input\", 33);\n    i0.ɵɵtemplate(16, EventFormComponent_div_39_div_16_Template, 2, 0, \"div\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 8)(18, \"label\", 31);\n    i0.ɵɵtext(19, \"El\\u00E9rhet\\u0151 jegyek\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(20, \"input\", 34);\n    i0.ɵɵtemplate(21, EventFormComponent_div_39_div_21_Template, 2, 0, \"div\", 11);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const i_r6 = ctx.index;\n    const ctx_r4 = i0.ɵɵnextContext();\n    let tmp_3_0;\n    let tmp_5_0;\n    let tmp_7_0;\n    let tmp_9_0;\n    let tmp_11_0;\n    let tmp_13_0;\n    i0.ɵɵproperty(\"formGroupName\", i_r6);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"Kateg\\u00F3ria \", i_r6 + 1, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"for\", \"name\" + i_r6);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"is-invalid\", ((tmp_3_0 = ctx_r4.ticketCategories.at(i_r6).get(\"name\")) == null ? null : tmp_3_0.invalid) && ((tmp_3_0 = ctx_r4.ticketCategories.at(i_r6).get(\"name\")) == null ? null : tmp_3_0.touched));\n    i0.ɵɵproperty(\"id\", \"name\" + i_r6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_5_0 = ctx_r4.ticketCategories.at(i_r6).get(\"name\")) == null ? null : tmp_5_0.invalid) && ((tmp_5_0 = ctx_r4.ticketCategories.at(i_r6).get(\"name\")) == null ? null : tmp_5_0.touched));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"for\", \"price\" + i_r6);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"is-invalid\", ((tmp_7_0 = ctx_r4.ticketCategories.at(i_r6).get(\"price\")) == null ? null : tmp_7_0.invalid) && ((tmp_7_0 = ctx_r4.ticketCategories.at(i_r6).get(\"price\")) == null ? null : tmp_7_0.touched));\n    i0.ɵɵproperty(\"id\", \"price\" + i_r6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_9_0 = ctx_r4.ticketCategories.at(i_r6).get(\"price\")) == null ? null : tmp_9_0.invalid) && ((tmp_9_0 = ctx_r4.ticketCategories.at(i_r6).get(\"price\")) == null ? null : tmp_9_0.touched));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"for\", \"availableTickets\" + i_r6);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"is-invalid\", ((tmp_11_0 = ctx_r4.ticketCategories.at(i_r6).get(\"availableTickets\")) == null ? null : tmp_11_0.invalid) && ((tmp_11_0 = ctx_r4.ticketCategories.at(i_r6).get(\"availableTickets\")) == null ? null : tmp_11_0.touched));\n    i0.ɵɵproperty(\"id\", \"availableTickets\" + i_r6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_13_0 = ctx_r4.ticketCategories.at(i_r6).get(\"availableTickets\")) == null ? null : tmp_13_0.invalid) && ((tmp_13_0 = ctx_r4.ticketCategories.at(i_r6).get(\"availableTickets\")) == null ? null : tmp_13_0.touched));\n  }\n}\nexport class EventFormComponent {\n  constructor(fb, eventService, route, router) {\n    this.fb = fb;\n    this.eventService = eventService;\n    this.route = route;\n    this.router = router;\n    this.isEditMode = false;\n    this.eventId = null;\n    this.loading = false;\n    this.error = null;\n    this.eventForm = this.fb.group({\n      title: ['', Validators.required],\n      description: ['', Validators.required],\n      date: ['', Validators.required],\n      location: ['', Validators.required],\n      imageUrl: [''],\n      ticketCategories: this.fb.array([])\n    });\n  }\n  ngOnInit() {\n    this.eventId = this.route.snapshot.paramMap.get('id');\n    if (this.eventId) {\n      this.isEditMode = true;\n      this.loadEvent(this.eventId);\n    }\n  }\n  get ticketCategories() {\n    return this.eventForm.get('ticketCategories');\n  }\n  addTicketCategory() {\n    this.ticketCategories.push(this.fb.group({\n      name: ['', Validators.required],\n      price: [0, [Validators.required, Validators.min(0)]],\n      availableTickets: [0, [Validators.required, Validators.min(0)]]\n    }));\n  }\n  removeTicketCategory(index) {\n    this.ticketCategories.removeAt(index);\n  }\n  loadEvent(id) {\n    this.loading = true;\n    this.eventService.getEvent(id).subscribe({\n      next: event => {\n        this.eventForm.patchValue({\n          title: event.title,\n          description: event.description,\n          date: new Date(event.date).toISOString().split('T')[0],\n          location: event.location,\n          imageUrl: event.imageUrl\n        });\n        event.ticketCategories.forEach(category => {\n          this.ticketCategories.push(this.fb.group({\n            name: [category.name, Validators.required],\n            price: [category.price, [Validators.required, Validators.min(0)]],\n            availableTickets: [category.availableTickets, [Validators.required, Validators.min(0)]]\n          }));\n        });\n        this.loading = false;\n      },\n      error: error => {\n        this.error = 'Hiba történt az esemény betöltése közben.';\n        this.loading = false;\n        console.error('Error loading event:', error);\n      }\n    });\n  }\n  onSubmit() {\n    if (this.eventForm.invalid) {\n      return;\n    }\n    this.loading = true;\n    // Az adatok előkészítése a form-ból\n    const formData = this.eventForm.value;\n    // Biztosítsuk, hogy legyen legalább egy jegykategoria, ha nincs formában\n    if (!formData.ticketCategories || formData.ticketCategories.length === 0) {\n      this.addTicketCategory();\n      formData.ticketCategories = [{\n        name: 'Alap jegy',\n        price: 1000,\n        availableTickets: 100\n      }];\n    }\n    // Kezeljük a hibahelyzetet, amikor a ticketCategories tömb, de üres\n    if (Array.isArray(formData.ticketCategories) && formData.ticketCategories.length === 0) {\n      formData.ticketCategories = [{\n        name: 'Alap jegy',\n        price: 1000,\n        availableTickets: 100\n      }];\n    }\n    // Szükéges formázások és kiegészítések\n    const newEventData = {\n      title: formData.title,\n      description: formData.description,\n      date: new Date(formData.date).toISOString(),\n      location: formData.location,\n      imageUrl: formData.imageUrl || '',\n      ticketCategories: formData.ticketCategories,\n      availableTickets: this.calculateTotalAvailableTickets(formData.ticketCategories)\n    };\n    console.log('Elküldött esemény adatok:', newEventData);\n    // Létrehozás vagy frissítés az edit mode alapján\n    if (this.isEditMode && this.eventId) {\n      // ID-t is megadunk az updateEvent-hez, mivel az már létező esemény (Event típus, nem NewEvent)\n      const existingEvent = {\n        _id: this.eventId,\n        ...newEventData\n      };\n      this.eventService.updateEvent(this.eventId, existingEvent).subscribe({\n        next: () => {\n          this.router.navigate(['/events', this.eventId]);\n        },\n        error: error => {\n          this.error = 'Hiba történt az esemény frissítése közben.';\n          this.loading = false;\n          console.error('Error updating event:', error);\n        }\n      });\n    } else {\n      this.eventService.createEvent(newEventData).subscribe({\n        next: event => {\n          this.router.navigate(['/events', event._id]);\n        },\n        error: error => {\n          this.error = 'Hiba történt az esemény létrehozása közben.';\n          this.loading = false;\n          console.error('Error creating event:', error);\n          // Teljes hiba megjelenítése debug célból\n          if (error.error) {\n            console.log('Szerver hiba részletei:', error.error);\n            if (error.error.message) {\n              console.log('Szerver hibaüzenet:', error.error.message);\n              this.error = `Szerver hiba: ${error.error.message}`;\n            }\n          }\n          // Utolsó mentsvarként próbáljuk meg string formátumra konvertálni a JSON objektumot\n          try {\n            const requestBody = JSON.stringify(newEventData);\n            console.log('Elküldött adatok stringként:', requestBody);\n          } catch (e) {\n            console.error('Hiba a JSON stringgelés során:', e);\n          }\n        }\n      });\n    }\n  }\n  /**\n   * Kiszámítja az összes elérhető jegy számát az összes kategóriából\n   */\n  calculateTotalAvailableTickets(categories) {\n    if (!categories || categories.length === 0) {\n      return 0;\n    }\n    return categories.reduce((total, category) => {\n      return total + (parseInt(category.availableTickets) || 0);\n    }, 0);\n  }\n  static {\n    this.ɵfac = function EventFormComponent_Factory(t) {\n      return new (t || EventFormComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.EventService), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i3.Router));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: EventFormComponent,\n      selectors: [[\"app-event-form\"]],\n      decls: 45,\n      vars: 17,\n      consts: [[1, \"container\", \"mt-4\"], [1, \"row\", \"justify-content-center\"], [1, \"col-md-8\"], [1, \"card\"], [1, \"card-header\"], [1, \"text-center\"], [1, \"card-body\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"mb-3\"], [\"for\", \"title\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"title\", \"formControlName\", \"title\", 1, \"form-control\"], [\"class\", \"invalid-feedback\", 4, \"ngIf\"], [\"for\", \"description\", 1, \"form-label\"], [\"id\", \"description\", \"formControlName\", \"description\", \"rows\", \"4\", 1, \"form-control\"], [\"for\", \"date\", 1, \"form-label\"], [\"type\", \"date\", \"id\", \"date\", \"formControlName\", \"date\", 1, \"form-control\"], [\"for\", \"location\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"location\", \"formControlName\", \"location\", 1, \"form-control\"], [\"for\", \"imageUrl\", 1, \"form-label\"], [\"type\", \"url\", \"id\", \"imageUrl\", \"formControlName\", \"imageUrl\", 1, \"form-control\"], [\"formArrayName\", \"ticketCategories\"], [1, \"d-flex\", \"justify-content-between\", \"align-items-center\", \"mb-3\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"class\", \"card mb-3\", 3, \"formGroupName\", 4, \"ngFor\", \"ngForOf\"], [1, \"d-grid\", \"gap-2\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"invalid-feedback\"], [1, \"card\", \"mb-3\", 3, \"formGroupName\"], [1, \"card-title\", \"mb-0\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", \"btn-sm\", 3, \"click\"], [1, \"form-label\", 3, \"for\"], [\"type\", \"text\", \"formControlName\", \"name\", 1, \"form-control\", 3, \"id\"], [\"type\", \"number\", \"formControlName\", \"price\", 1, \"form-control\", 3, \"id\"], [\"type\", \"number\", \"formControlName\", \"availableTickets\", 1, \"form-control\", 3, \"id\"]],\n      template: function EventFormComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h3\", 5);\n          i0.ɵɵtext(6);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(7, \"div\", 6)(8, \"form\", 7);\n          i0.ɵɵlistener(\"ngSubmit\", function EventFormComponent_Template_form_ngSubmit_8_listener() {\n            return ctx.onSubmit();\n          });\n          i0.ɵɵelementStart(9, \"div\", 8)(10, \"label\", 9);\n          i0.ɵɵtext(11, \"C\\u00EDm\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(12, \"input\", 10);\n          i0.ɵɵtemplate(13, EventFormComponent_div_13_Template, 2, 0, \"div\", 11);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(14, \"div\", 8)(15, \"label\", 12);\n          i0.ɵɵtext(16, \"Le\\u00EDr\\u00E1s\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(17, \"textarea\", 13);\n          i0.ɵɵtemplate(18, EventFormComponent_div_18_Template, 2, 0, \"div\", 11);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"div\", 8)(20, \"label\", 14);\n          i0.ɵɵtext(21, \"D\\u00E1tum\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(22, \"input\", 15);\n          i0.ɵɵtemplate(23, EventFormComponent_div_23_Template, 2, 0, \"div\", 11);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(24, \"div\", 8)(25, \"label\", 16);\n          i0.ɵɵtext(26, \"Helysz\\u00EDn\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(27, \"input\", 17);\n          i0.ɵɵtemplate(28, EventFormComponent_div_28_Template, 2, 0, \"div\", 11);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(29, \"div\", 8)(30, \"label\", 18);\n          i0.ɵɵtext(31, \"K\\u00E9p URL\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(32, \"input\", 19);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(33, \"div\", 20)(34, \"div\", 21)(35, \"h4\");\n          i0.ɵɵtext(36, \"Jegy kateg\\u00F3ri\\u00E1k\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(37, \"button\", 22);\n          i0.ɵɵlistener(\"click\", function EventFormComponent_Template_button_click_37_listener() {\n            return ctx.addTicketCategory();\n          });\n          i0.ɵɵtext(38, \" Kateg\\u00F3ria hozz\\u00E1ad\\u00E1sa \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(39, EventFormComponent_div_39_Template, 22, 17, \"div\", 23);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(40, \"div\", 24)(41, \"button\", 25);\n          i0.ɵɵtext(42);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(43, \"button\", 26);\n          i0.ɵɵlistener(\"click\", function EventFormComponent_Template_button_click_43_listener() {\n            return ctx.router.navigate([\"/events\"]);\n          });\n          i0.ɵɵtext(44, \" M\\u00E9gse \");\n          i0.ɵɵelementEnd()()()()()()()();\n        }\n        if (rf & 2) {\n          let tmp_2_0;\n          let tmp_3_0;\n          let tmp_4_0;\n          let tmp_5_0;\n          let tmp_6_0;\n          let tmp_7_0;\n          let tmp_8_0;\n          let tmp_9_0;\n          i0.ɵɵadvance(6);\n          i0.ɵɵtextInterpolate(ctx.isEditMode ? \"Esem\\u00E9ny szerkeszt\\u00E9se\" : \"\\u00DAj esem\\u00E9ny\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"formGroup\", ctx.eventForm);\n          i0.ɵɵadvance(4);\n          i0.ɵɵclassProp(\"is-invalid\", ((tmp_2_0 = ctx.eventForm.get(\"title\")) == null ? null : tmp_2_0.invalid) && ((tmp_2_0 = ctx.eventForm.get(\"title\")) == null ? null : tmp_2_0.touched));\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_3_0 = ctx.eventForm.get(\"title\")) == null ? null : tmp_3_0.invalid) && ((tmp_3_0 = ctx.eventForm.get(\"title\")) == null ? null : tmp_3_0.touched));\n          i0.ɵɵadvance(4);\n          i0.ɵɵclassProp(\"is-invalid\", ((tmp_4_0 = ctx.eventForm.get(\"description\")) == null ? null : tmp_4_0.invalid) && ((tmp_4_0 = ctx.eventForm.get(\"description\")) == null ? null : tmp_4_0.touched));\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_5_0 = ctx.eventForm.get(\"description\")) == null ? null : tmp_5_0.invalid) && ((tmp_5_0 = ctx.eventForm.get(\"description\")) == null ? null : tmp_5_0.touched));\n          i0.ɵɵadvance(4);\n          i0.ɵɵclassProp(\"is-invalid\", ((tmp_6_0 = ctx.eventForm.get(\"date\")) == null ? null : tmp_6_0.invalid) && ((tmp_6_0 = ctx.eventForm.get(\"date\")) == null ? null : tmp_6_0.touched));\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_7_0 = ctx.eventForm.get(\"date\")) == null ? null : tmp_7_0.invalid) && ((tmp_7_0 = ctx.eventForm.get(\"date\")) == null ? null : tmp_7_0.touched));\n          i0.ɵɵadvance(4);\n          i0.ɵɵclassProp(\"is-invalid\", ((tmp_8_0 = ctx.eventForm.get(\"location\")) == null ? null : tmp_8_0.invalid) && ((tmp_8_0 = ctx.eventForm.get(\"location\")) == null ? null : tmp_8_0.touched));\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_9_0 = ctx.eventForm.get(\"location\")) == null ? null : tmp_9_0.invalid) && ((tmp_9_0 = ctx.eventForm.get(\"location\")) == null ? null : tmp_9_0.touched));\n          i0.ɵɵadvance(11);\n          i0.ɵɵproperty(\"ngForOf\", ctx.ticketCategories.controls);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"disabled\", ctx.eventForm.invalid || ctx.loading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵtextInterpolate1(\" \", ctx.isEditMode ? \"Friss\\u00EDt\\u00E9s\" : \"L\\u00E9trehoz\\u00E1s\", \" \");\n        }\n      },\n      dependencies: [i4.NgForOf, i4.NgIf, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NumberValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i1.FormGroupName, i1.FormArrayName],\n      styles: [\".card[_ngcontent-%COMP%] {\\n  margin-bottom: 1rem;\\n}\\n\\n.form-control[_ngcontent-%COMP%]:focus {\\n  border-color: #80bdff;\\n  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);\\n}\\n\\n.btn[_ngcontent-%COMP%] {\\n  margin-right: 0.5rem;\\n} \\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9ldmVudC9ldmVudC1mb3JtL2V2ZW50LWZvcm0uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQixnREFBZ0Q7QUFDbEQ7O0FBRUE7RUFDRSxvQkFBb0I7QUFDdEIiLCJzb3VyY2VzQ29udGVudCI6WyIuY2FyZCB7XHJcbiAgbWFyZ2luLWJvdHRvbTogMXJlbTtcclxufVxyXG5cclxuLmZvcm0tY29udHJvbDpmb2N1cyB7XHJcbiAgYm9yZGVyLWNvbG9yOiAjODBiZGZmO1xyXG4gIGJveC1zaGFkb3c6IDAgMCAwIDAuMnJlbSByZ2JhKDAsIDEyMywgMjU1LCAwLjI1KTtcclxufVxyXG5cclxuLmJ0biB7XHJcbiAgbWFyZ2luLXJpZ2h0OiAwLjVyZW07XHJcbn0gIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["Validators","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","EventFormComponent_div_39_Template_button_click_5_listener","restoredCtx","ɵɵrestoreView","_r11","i_r6","index","ctx_r10","ɵɵnextContext","ɵɵresetView","removeTicketCategory","ɵɵelement","ɵɵtemplate","EventFormComponent_div_39_div_11_Template","EventFormComponent_div_39_div_16_Template","EventFormComponent_div_39_div_21_Template","ɵɵproperty","ɵɵadvance","ɵɵtextInterpolate1","ɵɵclassProp","tmp_3_0","ctx_r4","ticketCategories","at","get","invalid","touched","tmp_5_0","tmp_7_0","tmp_9_0","tmp_11_0","tmp_13_0","EventFormComponent","constructor","fb","eventService","route","router","isEditMode","eventId","loading","error","eventForm","group","title","required","description","date","location","imageUrl","array","ngOnInit","snapshot","paramMap","loadEvent","addTicketCategory","push","name","price","min","availableTickets","removeAt","id","getEvent","subscribe","next","event","patchValue","Date","toISOString","split","forEach","category","console","onSubmit","formData","value","length","Array","isArray","newEventData","calculateTotalAvailableTickets","log","existingEvent","_id","updateEvent","navigate","createEvent","message","requestBody","JSON","stringify","e","categories","reduce","total","parseInt","ɵɵdirectiveInject","i1","FormBuilder","i2","EventService","i3","ActivatedRoute","Router","selectors","decls","vars","consts","template","EventFormComponent_Template","rf","ctx","EventFormComponent_Template_form_ngSubmit_8_listener","EventFormComponent_div_13_Template","EventFormComponent_div_18_Template","EventFormComponent_div_23_Template","EventFormComponent_div_28_Template","EventFormComponent_Template_button_click_37_listener","EventFormComponent_div_39_Template","EventFormComponent_Template_button_click_43_listener","ɵɵtextInterpolate","tmp_2_0","tmp_4_0","tmp_6_0","tmp_8_0","controls"],"sources":["D:\\SZTE_PROGINFO\\programrendszerek_fejlesztese\\TicketPortal\\frontend\\src\\app\\components\\event\\event-form\\event-form.component.ts","D:\\SZTE_PROGINFO\\programrendszerek_fejlesztese\\TicketPortal\\frontend\\src\\app\\components\\event\\event-form\\event-form.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators, FormArray } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { EventService } from '../../../services/event.service';\nimport { Event, NewEvent, TicketCategory } from '../../../models/event.model';\n\n@Component({\n  selector: 'app-event-form',\n  templateUrl: './event-form.component.html',\n  styleUrls: ['./event-form.component.css']\n})\nexport class EventFormComponent implements OnInit {\n  eventForm: FormGroup;\n  isEditMode = false;\n  eventId: string | null = null;\n  loading = false;\n  error: string | null = null;\n\n  constructor(\n    private fb: FormBuilder,\n    private eventService: EventService,\n    private route: ActivatedRoute,\n    public router: Router\n  ) {\n    this.eventForm = this.fb.group({\n      title: ['', Validators.required],\n      description: ['', Validators.required],\n      date: ['', Validators.required],\n      location: ['', Validators.required],\n      imageUrl: [''],\n      ticketCategories: this.fb.array([])\n    });\n  }\n\n  ngOnInit(): void {\n    this.eventId = this.route.snapshot.paramMap.get('id');\n    if (this.eventId) {\n      this.isEditMode = true;\n      this.loadEvent(this.eventId);\n    }\n  }\n\n  get ticketCategories(): FormArray {\n    return this.eventForm.get('ticketCategories') as FormArray;\n  }\n\n  addTicketCategory(): void {\n    this.ticketCategories.push(this.fb.group({\n      name: ['', Validators.required],\n      price: [0, [Validators.required, Validators.min(0)]],\n      availableTickets: [0, [Validators.required, Validators.min(0)]]\n    }));\n  }\n\n  removeTicketCategory(index: number): void {\n    this.ticketCategories.removeAt(index);\n  }\n\n  loadEvent(id: string): void {\n    this.loading = true;\n    this.eventService.getEvent(id).subscribe({\n      next: (event: Event) => {\n        this.eventForm.patchValue({\n          title: event.title,\n          description: event.description,\n          date: new Date(event.date).toISOString().split('T')[0],\n          location: event.location,\n          imageUrl: event.imageUrl\n        });\n\n        event.ticketCategories.forEach((category: TicketCategory) => {\n          this.ticketCategories.push(this.fb.group({\n            name: [category.name, Validators.required],\n            price: [category.price, [Validators.required, Validators.min(0)]],\n            availableTickets: [category.availableTickets, [Validators.required, Validators.min(0)]]\n          }));\n        });\n\n        this.loading = false;\n      },\n      error: (error: any) => {\n        this.error = 'Hiba történt az esemény betöltése közben.';\n        this.loading = false;\n        console.error('Error loading event:', error);\n      }\n    });\n  }\n\n  onSubmit(): void {\n    if (this.eventForm.invalid) {\n      return;\n    }\n\n    this.loading = true;\n    \n    // Az adatok előkészítése a form-ból\n    const formData = this.eventForm.value;\n    \n    // Biztosítsuk, hogy legyen legalább egy jegykategoria, ha nincs formában\n    if (!formData.ticketCategories || formData.ticketCategories.length === 0) {\n      this.addTicketCategory();\n      formData.ticketCategories = [{\n        name: 'Alap jegy',\n        price: 1000,\n        availableTickets: 100\n      }];\n    }\n    \n    // Kezeljük a hibahelyzetet, amikor a ticketCategories tömb, de üres\n    if (Array.isArray(formData.ticketCategories) && formData.ticketCategories.length === 0) {\n      formData.ticketCategories = [{\n        name: 'Alap jegy',\n        price: 1000,\n        availableTickets: 100\n      }];\n    }\n    \n    // Szükéges formázások és kiegészítések\n    const newEventData: NewEvent = {\n      title: formData.title,\n      description: formData.description,\n      date: new Date(formData.date).toISOString(),\n      location: formData.location,\n      imageUrl: formData.imageUrl || '',\n      ticketCategories: formData.ticketCategories,\n      availableTickets: this.calculateTotalAvailableTickets(formData.ticketCategories)\n    };\n    \n    console.log('Elküldött esemény adatok:', newEventData);\n    \n    // Létrehozás vagy frissítés az edit mode alapján\n    if (this.isEditMode && this.eventId) {\n      // ID-t is megadunk az updateEvent-hez, mivel az már létező esemény (Event típus, nem NewEvent)\n      const existingEvent = {\n        _id: this.eventId,\n        ...newEventData\n      };\n      this.eventService.updateEvent(this.eventId, existingEvent).subscribe({\n        next: () => {\n          this.router.navigate(['/events', this.eventId]);\n        },\n        error: (error: any) => {\n          this.error = 'Hiba történt az esemény frissítése közben.';\n          this.loading = false;\n          console.error('Error updating event:', error);\n        }\n      });\n    } else {\n      this.eventService.createEvent(newEventData).subscribe({\n        next: (event: Event) => {\n          this.router.navigate(['/events', event._id]);\n        },\n        error: (error: any) => {\n          this.error = 'Hiba történt az esemény létrehozása közben.';\n          this.loading = false;\n          console.error('Error creating event:', error);\n          \n          // Teljes hiba megjelenítése debug célból\n          if (error.error) {\n            console.log('Szerver hiba részletei:', error.error);\n            if (error.error.message) {\n              console.log('Szerver hibaüzenet:', error.error.message);\n              this.error = `Szerver hiba: ${error.error.message}`;\n            }\n          }\n          \n          // Utolsó mentsvarként próbáljuk meg string formátumra konvertálni a JSON objektumot\n          try {\n            const requestBody = JSON.stringify(newEventData);\n            console.log('Elküldött adatok stringként:', requestBody);\n          } catch (e) {\n            console.error('Hiba a JSON stringgelés során:', e);\n          }\n        }\n      });\n    }\n  }\n  \n  /**\n   * Kiszámítja az összes elérhető jegy számát az összes kategóriából\n   */\n  private calculateTotalAvailableTickets(categories: any[]): number {\n    if (!categories || categories.length === 0) {\n      return 0;\n    }\n    \n    return categories.reduce((total, category) => {\n      return total + (parseInt(category.availableTickets) || 0);\n    }, 0);\n  }\n} ","<div class=\"container mt-4\">\r\n  <div class=\"row justify-content-center\">\r\n    <div class=\"col-md-8\">\r\n      <div class=\"card\">\r\n        <div class=\"card-header\">\r\n          <h3 class=\"text-center\">{{ isEditMode ? 'Esemény szerkesztése' : 'Új esemény' }}</h3>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <form [formGroup]=\"eventForm\" (ngSubmit)=\"onSubmit()\">\r\n            <div class=\"mb-3\">\r\n              <label for=\"title\" class=\"form-label\">Cím</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                id=\"title\"\r\n                formControlName=\"title\"\r\n                [class.is-invalid]=\"eventForm.get('title')?.invalid && eventForm.get('title')?.touched\"\r\n              >\r\n              <div class=\"invalid-feedback\" *ngIf=\"eventForm.get('title')?.invalid && eventForm.get('title')?.touched\">\r\n                A cím megadása kötelező\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"mb-3\">\r\n              <label for=\"description\" class=\"form-label\">Leírás</label>\r\n              <textarea\r\n                class=\"form-control\"\r\n                id=\"description\"\r\n                formControlName=\"description\"\r\n                rows=\"4\"\r\n                [class.is-invalid]=\"eventForm.get('description')?.invalid && eventForm.get('description')?.touched\"\r\n              ></textarea>\r\n              <div class=\"invalid-feedback\" *ngIf=\"eventForm.get('description')?.invalid && eventForm.get('description')?.touched\">\r\n                A leírás megadása kötelező\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"mb-3\">\r\n              <label for=\"date\" class=\"form-label\">Dátum</label>\r\n              <input\r\n                type=\"date\"\r\n                class=\"form-control\"\r\n                id=\"date\"\r\n                formControlName=\"date\"\r\n                [class.is-invalid]=\"eventForm.get('date')?.invalid && eventForm.get('date')?.touched\"\r\n              >\r\n              <div class=\"invalid-feedback\" *ngIf=\"eventForm.get('date')?.invalid && eventForm.get('date')?.touched\">\r\n                A dátum megadása kötelező\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"mb-3\">\r\n              <label for=\"location\" class=\"form-label\">Helyszín</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                id=\"location\"\r\n                formControlName=\"location\"\r\n                [class.is-invalid]=\"eventForm.get('location')?.invalid && eventForm.get('location')?.touched\"\r\n              >\r\n              <div class=\"invalid-feedback\" *ngIf=\"eventForm.get('location')?.invalid && eventForm.get('location')?.touched\">\r\n                A helyszín megadása kötelező\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"mb-3\">\r\n              <label for=\"imageUrl\" class=\"form-label\">Kép URL</label>\r\n              <input\r\n                type=\"url\"\r\n                class=\"form-control\"\r\n                id=\"imageUrl\"\r\n                formControlName=\"imageUrl\"\r\n              >\r\n            </div>\r\n\r\n            <div formArrayName=\"ticketCategories\">\r\n              <div class=\"d-flex justify-content-between align-items-center mb-3\">\r\n                <h4>Jegy kategóriák</h4>\r\n                <button type=\"button\" class=\"btn btn-primary\" (click)=\"addTicketCategory()\">\r\n                  Kategória hozzáadása\r\n                </button>\r\n              </div>\r\n\r\n              <div\r\n                *ngFor=\"let category of ticketCategories.controls; let i = index\"\r\n                [formGroupName]=\"i\"\r\n                class=\"card mb-3\"\r\n              >\r\n                <div class=\"card-body\">\r\n                  <div class=\"d-flex justify-content-between align-items-center mb-3\">\r\n                    <h5 class=\"card-title mb-0\">Kategória {{ i + 1 }}</h5>\r\n                    <button\r\n                      type=\"button\"\r\n                      class=\"btn btn-danger btn-sm\"\r\n                      (click)=\"removeTicketCategory(i)\"\r\n                    >\r\n                      Törlés\r\n                    </button>\r\n                  </div>\r\n\r\n                  <div class=\"mb-3\">\r\n                    <label [for]=\"'name' + i\" class=\"form-label\">Név</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      class=\"form-control\"\r\n                      [id]=\"'name' + i\"\r\n                      formControlName=\"name\"\r\n                      [class.is-invalid]=\"ticketCategories.at(i).get('name')?.invalid && ticketCategories.at(i).get('name')?.touched\"\r\n                    >\r\n                    <div\r\n                      class=\"invalid-feedback\"\r\n                      *ngIf=\"ticketCategories.at(i).get('name')?.invalid && ticketCategories.at(i).get('name')?.touched\"\r\n                    >\r\n                      A név megadása kötelező\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div class=\"mb-3\">\r\n                    <label [for]=\"'price' + i\" class=\"form-label\">Ár</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      class=\"form-control\"\r\n                      [id]=\"'price' + i\"\r\n                      formControlName=\"price\"\r\n                      [class.is-invalid]=\"ticketCategories.at(i).get('price')?.invalid && ticketCategories.at(i).get('price')?.touched\"\r\n                    >\r\n                    <div\r\n                      class=\"invalid-feedback\"\r\n                      *ngIf=\"ticketCategories.at(i).get('price')?.invalid && ticketCategories.at(i).get('price')?.touched\"\r\n                    >\r\n                      Az ár megadása kötelező és nem lehet negatív\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div class=\"mb-3\">\r\n                    <label [for]=\"'availableTickets' + i\" class=\"form-label\">Elérhető jegyek</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      class=\"form-control\"\r\n                      [id]=\"'availableTickets' + i\"\r\n                      formControlName=\"availableTickets\"\r\n                      [class.is-invalid]=\"ticketCategories.at(i).get('availableTickets')?.invalid && ticketCategories.at(i).get('availableTickets')?.touched\"\r\n                    >\r\n                    <div\r\n                      class=\"invalid-feedback\"\r\n                      *ngIf=\"ticketCategories.at(i).get('availableTickets')?.invalid && ticketCategories.at(i).get('availableTickets')?.touched\"\r\n                    >\r\n                      Az elérhető jegyek számának megadása kötelező és nem lehet negatív\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"d-grid gap-2\">\r\n              <button type=\"submit\" class=\"btn btn-primary\" [disabled]=\"eventForm.invalid || loading\">\r\n                {{ isEditMode ? 'Frissítés' : 'Létrehozás' }}\r\n              </button>\r\n              <button type=\"button\" class=\"btn btn-secondary\" (click)=\"router.navigate(['/events'])\">\r\n                Mégse\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}